<!DOCTYPE html>
<!-- saved from url=(0046)http://evanribey.com/visualizations/histogram/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
	<title>Flu Season Histogram</title>
	<style type="text/css">
		body {
			font: 11px sans-serif;
			padding: 10px 5%;
		}

		p {
			font-size: 140%;
		}

		.container {
			border: 1px solid #ccc;
			margin: 0 auto;
			position: relative;
			text-align: center;
			vertical-align: middle;
			width: 960px;
		}

		.vector {
			display: inline-block;
		}

		.bar {
			fill: steelblue;
			transition: 0.3s;
		}

		.bar:hover {
			fill: brown;
		}

		.x.axis path {
			display: none;
		}

	</style>
	<script src="./Flu Season Histogram_files/d3.v4.min.js"></script>
</head>
<body>
<h1>Canadian Flu Season Histogram</h1>
<p>A histogram visualization illustrating the maximum amount of hospitalizations per month for the flu in Canada. The graphic also allows for the selection of previous flu seasons in order to compare between each and redraw the visualization from the dropdown menu. <a href="http://open.canada.ca/data/en/dataset?q=flu+watch&amp;sort=metadata_modified+desc">Data source</a>.</p>
<div class="container">
<form style="text-align: right; padding: 4px 2px 0 0;">
	<select id="year">
		<option value="2013-2014">2013-2014</option>
		<option value="2012-2013">2012-2013</option>
		<option value="2011-2012">2011-2012</option>
		<option value="2010-2011">2010-2011</option>
	</select>  
</form>
<svg class="vector" height="500" width="960"><g transform="translate(40,20)"><g class="x axis" transform="translate(0,450)" fill="none" font-size="10" font-family="sans-serif" text-anchor="middle"><path class="domain" stroke="#000" d="M0.5,6V0.5H880.5V6"></path><g class="tick" opacity="1" transform="translate(0.5, 0)"><line stroke="#000" y2="6"></line><text fill="#000" y="9" dy="0.71em">September</text></g><g class="tick" opacity="1" transform="translate(74.5, 0)"><line stroke="#000" y2="6"></line><text fill="#000" y="9" dy="0.71em">October</text></g><g class="tick" opacity="1" transform="translate(150.5, 0)"><line stroke="#000" y2="6"></line><text fill="#000" y="9" dy="0.71em">November</text></g><g class="tick" opacity="1" transform="translate(224.5, 0)"><line stroke="#000" y2="6"></line><text fill="#000" y="9" dy="0.71em">December</text></g><g class="tick" opacity="1" transform="translate(301.5, 0)"><line stroke="#000" y2="6"></line><text fill="#000" y="9" dy="0.71em">2014</text></g><g class="tick" opacity="1" transform="translate(377.5, 0)"><line stroke="#000" y2="6"></line><text fill="#000" y="9" dy="0.71em">February</text></g><g class="tick" opacity="1" transform="translate(446.5, 0)"><line stroke="#000" y2="6"></line><text fill="#000" y="9" dy="0.71em">March</text></g><g class="tick" opacity="1" transform="translate(523.5, 0)"><line stroke="#000" y2="6"></line><text fill="#000" y="9" dy="0.71em">April</text></g><g class="tick" opacity="1" transform="translate(597.5, 0)"><line stroke="#000" y2="6"></line><text fill="#000" y="9" dy="0.71em">May</text></g><g class="tick" opacity="1" transform="translate(673.5, 0)"><line stroke="#000" y2="6"></line><text fill="#000" y="9" dy="0.71em">June</text></g><g class="tick" opacity="1" transform="translate(747.5, 0)"><line stroke="#000" y2="6"></line><text fill="#000" y="9" dy="0.71em">July</text></g><g class="tick" opacity="1" transform="translate(823.5, 0)"><line stroke="#000" y2="6"></line><text fill="#000" y="9" dy="0.71em">August</text></g></g><g class="y axis" fill="none" font-size="10" font-family="sans-serif" text-anchor="end"><path class="domain" stroke="#000" d="M-6,450.5H0.5V0.5H-6"></path><g class="tick" opacity="1" transform="translate(0,450.5)"><line stroke="#000" x2="-6"></line><text fill="#000" x="-9" dy="0.32em">0</text></g><g class="tick" opacity="1" transform="translate(0, 396.9285583496094)"><line stroke="#000" x2="-6"></line><text fill="#000" x="-9" dy="0.32em">50</text></g><g class="tick" opacity="1" transform="translate(0, 343.3571472167969)"><line stroke="#000" x2="-6"></line><text fill="#000" x="-9" dy="0.32em">100</text></g><g class="tick" opacity="1" transform="translate(0, 289.78570556640625)"><line stroke="#000" x2="-6"></line><text fill="#000" x="-9" dy="0.32em">150</text></g><g class="tick" opacity="1" transform="translate(0, 236.2142791748047)"><line stroke="#000" x2="-6"></line><text fill="#000" x="-9" dy="0.32em">200</text></g><g class="tick" opacity="1" transform="translate(0, 182.64285278320312)"><line stroke="#000" x2="-6"></line><text fill="#000" x="-9" dy="0.32em">250</text></g><g class="tick" opacity="1" transform="translate(0, 129.07142639160156)"><line stroke="#000" x2="-6"></line><text fill="#000" x="-9" dy="0.32em">300</text></g><g class="tick" opacity="1" transform="translate(0, 75.5)"><line stroke="#000" x2="-6"></line><text fill="#000" x="-9" dy="0.32em">350</text></g><g class="tick" opacity="1" transform="translate(0, 21.928571701049805)"><line stroke="#000" x2="-6"></line><text fill="#000" x="-9" dy="0.32em">400</text></g></g><text transform="rotate(-90)" y="6" dy="0.71em" text-anchor="end">Count</text><rect class="bar" height="2.142857142857167" y="447.85714285714283" x="0" width="74"></rect><rect class="bar" height="1.0714285714285552" y="448.92857142857144" x="74" width="76"></rect><rect class="bar" height="21.428571428571445" y="428.57142857142856" x="150" width="74"></rect><rect class="bar" height="193.92857142857144" y="256.07142857142856" x="224" width="77"></rect><rect class="bar" height="450" y="0" x="301" width="76"></rect><rect class="bar" height="252.85714285714286" y="197.14285714285714" x="377" width="69"></rect><rect class="bar" height="145.71428571428572" y="304.2857142857143" x="446" width="77"></rect><rect class="bar" height="32.14285714285711" y="417.8571428571429" x="523" width="74"></rect><rect class="bar" height="38.571428571428555" y="411.42857142857144" x="597" width="76"></rect><rect class="bar" height="27.857142857142833" y="422.14285714285717" x="673" width="74"></rect><rect class="bar" height="15" y="435" x="747" width="76"></rect><rect class="bar" height="1.0714285714285552" y="448.92857142857144" x="823" width="57"></rect></g></svg></div>
<script type="text/javascript">
	var	svg = d3.select(".container").append("svg")
			.attr("class", "vector")
			.attr("height", 500)
			.attr("width", 960);
	
	var	margin = {top: 20, right: 40, bottom: 30, left: 40},
		width = svg.attr("width") - margin.left - margin.right,
		height = svg.attr("height") - margin.top - margin.bottom;

	var parseTime = d3.timeParse("%Y-%U");

	var	x = d3.scaleTime().rangeRound([0, width]),
		y = d3.scaleLinear().range([height, 0]);

	var axisX = d3.axisBottom(x);
	var axisY = d3.axisLeft(y).ticks(10);

	var g = svg.append("g")
			.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

	g.append("g")
		.attr("class", "x axis")
		.attr("transform", "translate(0," + height + ")");

	g.append("g")
		.attr("class", "y axis");

	g.append("text")
			.attr("transform", "rotate(-90)")
			.attr("y", 6)
			.attr("dy", "0.71em")
			.attr("text-anchor", "end")
			.text("Count");
	
	update(document.getElementById("year").value);
	update(document.getElementById("year").value);

	document.getElementById("year").onchange = function() {
		update(document.getElementById("year").value);	
	}
	
	function update(year) {
		d3.tsv(year+"-flu-hospitalizations.tsv", function(d) {
			d.date = parseTime(d.date);
			d.hospitalizations = +d.hospitalizations;
			return d;
		}, function(error, data) {
			if(error) throw error;

			x.domain(d3.extent(data, function(d) { return d.date; }));
			
			var bins = d3.histogram()
				.value(function(d) { return d.date; })
				.domain(x.domain())
				.thresholds(x.ticks(12))
				(data);

			y.domain([0, d3.max(bins, function(d) { return d3.max(d, function(j) { return j.hospitalizations; })})]);
			
			var bar = g.selectAll(".bar").data(bins);

			bar.enter().append("rect")
				.attr("class", "bar")
				.attr("height", height - y(0))
				.attr("y", y(0));

			bar.transition().duration(300)
					.attr("x", function(d) { return x(d.x0);})
					.attr("y", function(d) { return y(d3.max(d, function(j) { return j.hospitalizations; }));})
					.attr("width", function(d) {return x(d.x1) - x(d.x0);})
					.attr("height", function(d) { return height - y(d3.max(d, function(j) { return j.hospitalizations; })); });
			
			bar.exit()
				.transition()
				      .duration(300)
				    .attr("y", y(0))
				    .attr("height", height - y(0))
				    .style('fill-opacity', 1e-6)
				.remove();

			g.select(".y.axis").transition().duration(300).call(axisY);
			g.select(".x.axis").transition().duration(300).call(axisX);
		});
	}

</script>

</body></html>